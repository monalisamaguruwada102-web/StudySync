import{r as n,j as e}from"./vendor-BHBgCXd7.js";import{L as P}from"./Layout-B83BWzRM.js";import{C as V}from"./Card-FPDh96Dz.js";import{B as r}from"./Button-Cg-uFP-H.js";import{I as W}from"./Input-Bxxkotjn.js";import{M as S}from"./Modal-DoZe7KXC.js";import{u as I}from"./useFirestore-BslRrM8B.js";import{c as h,f as z,m as Z}from"./index-Bt0XpbVC.js";import{a as ee}from"./aiService-DALbnsgD.js";import{Y as ae,_ as se,i as te,P as L,N as re,$,n as le,B as ne}from"./icons-BEGX_Ie2.js";const ge=()=>{const{data:q,refresh:B}=I(z.getAll),{data:A,refresh:g}=I(h.getAll),{data:D}=I(Z.getAll),[i,j]=n.useState(null),[R,b]=n.useState(!1),[E,x]=n.useState(!1),[Q,m]=n.useState(!1),[d,y]=n.useState({name:"",moduleId:""}),[c,k]=n.useState({front:"",back:""}),[p,T]=n.useState([]),[o,F]=n.useState(0),[v,N]=n.useState(!1),[H,u]=n.useState(!1),[f,M]=n.useState(""),[C,G]=n.useState(!1),X=async a=>{a.preventDefault(),await z.add(d),await B(),x(!1),y({name:"",moduleId:""})},Y=async a=>{a.preventDefault(),await h.add({...c,deckId:i.id,level:1,nextReview:new Date().toISOString()}),await g(),m(!1),k({front:"",back:""})},_=a=>{const s=A.filter(t=>t.deckId===a.id);if(s.length===0){alert("Add some cards to this deck first!");return}T([...s].sort((t,l)=>t.level-l.level)),F(0),j(a),b(!0),N(!1)},O=async a=>{const s=p[o];let t=s.level;a?t=Math.min(s.level+1,5):t=Math.max(s.level-1,1),await h.update(s.id,{level:t}),await g(),o<p.length-1?(F(o+1),N(!1)):(b(!1),alert("Study session complete!"))},J=async()=>{if(!f.trim()){alert("Please provide some context text for AI generation.");return}G(!0);try{const a=D.find(t=>t.id===i.moduleId)?.name||"General",s=await ee.generateFlashcards(a,f);for(const t of s)await h.add({front:t.question,back:t.answer,deckId:i.id,level:t.level||1,nextReview:new Date().toISOString()});await g(),u(!1),M(""),alert(`Successfully generated ${s.length} cards!`)}catch(a){console.error("AI Generation failed:",a),alert("AI Service failed. Please check your API key.")}finally{G(!1)}};if(R){const a=p[o];return e.jsx(P,{title:`Studying: ${i.name}`,children:e.jsxs("div",{className:"max-w-2xl mx-auto py-12",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(r,{variant:"ghost",onClick:()=>b(!1),className:"flex items-center gap-2",children:[e.jsx(ae,{size:20}),e.jsx("span",{children:"Exit Session"})]}),e.jsxs("div",{className:"text-sm font-bold text-slate-500",children:["Card ",o+1," of ",p.length]})]}),e.jsx("div",{className:"relative h-[400px] w-full cursor-pointer perspective-1000",onClick:()=>N(!v),children:e.jsxs("div",{className:`w-full h-full transition-all duration-500 transform-style-3d relative ${v?"rotate-y-180":""}`,children:[e.jsxs("div",{className:"absolute inset-0 backface-hidden bg-white dark:bg-slate-900 border-2 border-primary-100 dark:border-primary-900/30 rounded-3xl shadow-xl flex flex-col items-center justify-center p-12 text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-primary-500 mb-4 tracking-widest",children:"Question"}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:a.front}),e.jsx("p",{className:"mt-8 text-xs text-slate-400 italic",children:"Click to flip"})]}),e.jsxs("div",{className:"absolute inset-0 backface-hidden rotate-y-180 bg-primary-50 dark:bg-primary-900/10 border-2 border-primary-200 dark:border-primary-800 rounded-3xl shadow-xl flex flex-col items-center justify-center p-12 text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-primary-600 dark:text-primary-400 mb-4 tracking-widest",children:"Answer"}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:a.back}),e.jsx("p",{className:"mt-8 text-xs text-slate-400 italic",children:"Click to flip back"})]})]})}),v&&e.jsxs("div",{className:"flex gap-4 mt-8 animate-in fade-in slide-in-from-bottom-4",children:[e.jsxs(r,{variant:"danger",className:"flex-1 py-4 rounded-2xl flex items-center justify-center gap-2 h-16",onClick:s=>{s.stopPropagation(),O(!1)},children:[e.jsx(se,{size:24}),e.jsx("span",{children:"Still Learning"})]}),e.jsxs(r,{variant:"primary",className:"flex-1 py-4 rounded-2xl bg-green-600 hover:bg-green-700 flex items-center justify-center gap-2 h-16",onClick:s=>{s.stopPropagation(),O(!0)},children:[e.jsx(te,{size:24}),e.jsx("span",{children:"Mastered It"})]})]})]})})}return e.jsxs(P,{title:"Spaced Repetition Flashcards",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Study Decks"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Master complex IT concepts with the Leitner System."})]}),e.jsxs(r,{onClick:()=>x(!0),className:"flex items-center gap-2",children:[e.jsx(L,{size:20}),e.jsx("span",{children:"Create Deck"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:q.map(a=>{const s=A.filter(l=>l.deckId===a.id),t=s.length>0?(s.reduce((l,w)=>l+w.level,0)/s.length).toFixed(1):0;return e.jsx(V,{title:a.name,HeaderAction:e.jsxs("div",{className:"flex items-center gap-2 text-primary-600 bg-primary-50 dark:bg-primary-900/20 px-2 py-1 rounded-lg text-xs font-bold",children:[e.jsx(le,{size:14}),e.jsxs("span",{children:[s.length," Cards"]})]}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Mastery Progress"}),e.jsxs("span",{className:"font-bold text-slate-800 dark:text-slate-100",children:["Avg. Level ",t," / 5"]})]}),e.jsx("div",{className:"flex gap-1 h-2",children:[1,2,3,4,5].map(l=>{const w=s.filter(U=>U.level===l).length,K=s.length>0?w/s.length*100:0;return e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${l===1?"bg-red-400":l===2?"bg-orange-400":l===3?"bg-yellow-400":l===4?"bg-blue-400":"bg-green-500"}`,style:{width:`${K}%`}},l)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"primary",className:"flex-1 flex items-center justify-center gap-2",onClick:()=>_(a),disabled:s.length===0,children:[e.jsx(re,{size:16}),e.jsx("span",{children:"Study Now"})]}),e.jsx(r,{variant:"secondary",className:"px-3",title:"AI Generate Cards",onClick:()=>{j(a),u(!0)},children:e.jsx($,{size:16,className:"text-purple-500"})}),e.jsx(r,{variant:"secondary",className:"px-3",onClick:()=>{j(a),m(!0)},children:e.jsx(L,{size:16})})]})]})},a.id)})}),e.jsx(S,{isOpen:E,onClose:()=>x(!1),title:"Create New Deck",footer:e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"secondary",onClick:()=>x(!1),children:"Cancel"}),e.jsx(r,{variant:"primary",onClick:X,children:"Create Deck"})]}),children:e.jsxs("form",{className:"space-y-4",children:[e.jsx(W,{label:"Deck Name",placeholder:"e.g. Networking Fundamentals",value:d.name,onChange:a=>y({...d,name:a.target.value}),required:!0}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Module"}),e.jsxs("select",{className:"px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 dark:text-slate-100",value:d.moduleId,onChange:a=>y({...d,moduleId:a.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select a module"}),D.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})]})}),e.jsx(S,{isOpen:Q,onClose:()=>m(!1),title:`Add Card to ${i?.name}`,footer:e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx(r,{variant:"primary",onClick:Y,children:"Add Card"})]}),children:e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Front (Question)"}),e.jsx("textarea",{className:"px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 dark:text-slate-100 min-h-[100px]",value:c.front,onChange:a=>k({...c,front:a.target.value}),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Back (Answer)"}),e.jsx("textarea",{className:"px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 dark:text-slate-100 min-h-[100px]",value:c.back,onChange:a=>k({...c,back:a.target.value}),required:!0})]})]})}),e.jsx(S,{isOpen:H,onClose:()=>u(!1),title:`AI Flashcard Generator (Deck: ${i?.name})`,footer:e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"secondary",onClick:()=>u(!1),children:"Cancel"}),e.jsx(r,{variant:"primary",onClick:J,disabled:C||!f.trim(),className:"bg-gradient-to-r from-purple-600 to-primary-600 h-11",children:C?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Generating..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{size:18}),e.jsx("span",{children:"Generate with AI"})]})})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/10 border border-purple-100 dark:border-purple-900/30 rounded-2xl flex gap-3",children:[e.jsx(ne,{className:"text-purple-500 shrink-0",size:20}),e.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-300 leading-relaxed",children:"Paste your study notes, a chapter summary, or technical documentation below. StudySync AI will convert it into a set of high-quality flashcards for your deck."})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Context Text"}),e.jsx("textarea",{className:"px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 dark:text-slate-100 min-h-[200px]",placeholder:"Paste notes here...",value:f,onChange:a=>M(a.target.value),disabled:C})]})]})})]})};export{ge as default};
