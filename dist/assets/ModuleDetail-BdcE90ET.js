import{t as I,u as F,r as l,j as e,m as w}from"./vendor-BHBgCXd7.js";import{L as v}from"./Layout-BW6pkOKI.js";import{C as d}from"./Card-FPDh96Dz.js";import{B as m}from"./Button-Cg-uFP-H.js";import{u as i}from"./useFirestore-BslRrM8B.js";import{u as $}from"./useAnalytics-C4G8BC_B.js";import{m as B,t as P,s as W,n as E,f as G,c as O,p as R}from"./index-DJ53ofb6.js";import{ar as q,W as K,N as C,k as S,v as U,n as J,l as z,a0 as A,T as Q,z as V,q as X,f as Y,K as Z,P as T}from"./icons-BEGX_Ie2.js";import"./startOfWeek-Bny05VrO.js";import"./toDate-BKXxHYqX.js";import"./endOfWeek-B_3EXgRf.js";const oe=()=>{const{id:t}=I(),r=F(),{data:p,loading:D}=i(B.getAll),{data:h}=i(P.getAll),{data:u}=i(W.getAll),{data:L}=i(R.getAll),[x,M]=l.useState("overview"),{data:b}=i(E.getAll),{data:k}=i(G.getAll),{data:g}=i(O.getAll),c=l.useMemo(()=>p.find(s=>s.id===t),[p,t]),n=l.useMemo(()=>h.filter(s=>s.moduleId===t),[h,t]),f=l.useMemo(()=>u.filter(s=>s.moduleId===t),[u,t]),H=l.useMemo(()=>b.filter(s=>s.moduleId===t),[b,t]),j=l.useMemo(()=>k.filter(s=>s.moduleId===t),[k,t]);l.useMemo(()=>{const s=j.map(a=>a.id);return g.filter(a=>s.includes(a.deckId))},[g,j]);const y=$(u,p,h,L),o=l.useMemo(()=>{const s=y.moduleData.find(N=>N.id===t);if(!s)return{progress:0,hours:0,completedTasks:0,totalTasks:0};const a=n.filter(N=>N.status==="Completed").length;return{progress:s.progress.toFixed(0),hours:s.hours.toFixed(1),completedTasks:a,totalTasks:n.length}},[y,n,t]);return D?e.jsx(v,{title:"Loading...",children:e.jsx("div",{className:"flex items-center justify-center h-64 text-slate-400",children:"Loading module data..."})}):c?e.jsxs(v,{title:c.name,children:[e.jsxs("div",{className:"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>r(-1),className:"p-3 bg-white/50 dark:bg-slate-800 rounded-2xl hover:bg-white dark:hover:bg-slate-700 transition-all shadow-sm group",children:e.jsx(q,{size:20,className:"group-hover:-translate-x-1 transition-transform"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-slate-100 tracking-tight",children:c.name}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-medium",children:"Detailed progress and study metrics"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(m,{variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(K,{size:18}),e.jsx("span",{children:"AI Study Guide"})]}),e.jsxs(m,{variant:"primary",className:"flex items-center gap-2",onClick:()=>r("/logs"),children:[e.jsx(C,{size:18,fill:"currentColor"}),e.jsx("span",{children:"Start Session"})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 mb-6 p-1 bg-slate-100 dark:bg-slate-800/50 rounded-2xl w-fit",children:[{id:"overview",label:"Overview",icon:S},{id:"notes",label:"Notes",icon:U},{id:"flashcards",label:"Flashcards",icon:J}].map(s=>e.jsxs("button",{onClick:()=>M(s.id),className:`
                            flex items-center gap-2 px-6 py-2.5 rounded-xl text-xs font-black uppercase tracking-widest transition-all
                            ${x===s.id?"bg-white dark:bg-slate-700 text-primary-500 shadow-sm":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}
                        `,children:[e.jsx(s.icon,{size:14}),s.label]},s.id))}),x==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(d,{className:"relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary-500/5 blur-3xl -mr-20 -mt-20 rounded-full"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8 relative z-10",children:[e.jsxs("div",{className:"relative w-32 h-32 flex-shrink-0",children:[e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",children:[e.jsx("circle",{className:"text-slate-100 dark:text-slate-800",strokeWidth:"8",stroke:"currentColor",fill:"transparent",r:"40",cx:"50",cy:"50"}),e.jsx(w.circle,{className:"text-primary-500",strokeWidth:"8",strokeDasharray:251.2,initial:{strokeDashoffset:251.2},animate:{strokeDashoffset:251.2-251.2*o.progress/100},strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"40",cx:"50",cy:"50"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-black text-slate-900 dark:text-slate-100",children:[o.progress,"%"]})})]}),e.jsx("div",{className:"flex-1 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-1",children:"Target Hours"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{size:18,className:"text-primary-500"}),e.jsxs("span",{className:"text-xl font-bold",children:[c.targetHours,"h"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-1",children:"Total Studied"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:18,className:"text-blue-500"}),e.jsxs("span",{className:"text-xl font-bold",children:[o.hours,"h"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-1",children:"Task Completion"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{size:18,className:"text-green-500"}),e.jsxs("span",{className:"text-xl font-bold",children:[o.completedTasks,"/",o.totalTasks]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-1",children:"Study Streak"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{size:18,className:"text-orange-500"}),e.jsx("span",{className:"text-xl font-bold",children:"12 Days"})]})]})]})})]})]}),e.jsx(d,{title:"Module Learning Path",HeaderAction:e.jsx(X,{size:18,className:"text-slate-400"}),children:e.jsx("div",{className:"space-y-3",children:n.length>0?n.map((s,a)=>e.jsxs(w.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:a*.05},className:`flex items-center justify-between p-4 rounded-2xl border ${s.status==="Completed"?"bg-green-50/50 dark:bg-green-900/10 border-green-100/50 dark:border-green-900/20":"bg-slate-50 dark:bg-slate-800 border-slate-100 dark:border-slate-800"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:s.status==="Completed"?"text-green-500":"text-slate-300",children:s.status==="Completed"?e.jsx(A,{size:24}):e.jsx(V,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:`text-sm font-bold ${s.status==="Completed"?"text-green-700 dark:text-green-400 line-through":"text-slate-800 dark:text-slate-200"}`,children:s.title}),e.jsxs("p",{className:"text-[10px] font-medium text-slate-500",children:["Due: ",s.dueDate||"No date"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`text-[9px] font-black uppercase px-2 py-0.5 rounded-full ${s.priority==="High"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:s.priority})})]},s.id)):e.jsx("div",{className:"text-center py-12 text-slate-400 italic text-sm",children:"No tasks created for this module yet."})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(d,{title:"About Module",HeaderAction:e.jsx(Y,{size:18,className:"text-primary-500"}),children:e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 leading-relaxed",children:c.description||"No description provided for this module."})}),e.jsx(d,{title:"Study History",children:e.jsxs("div",{className:"space-y-4",children:[f.slice(0,5).map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3 relative pb-4 last:pb-0",children:[a!==f.slice(0,5).length-1&&e.jsx("div",{className:"absolute left-[11px] top-6 bottom-0 w-[2px] bg-slate-100 dark:bg-slate-800"}),e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center text-primary-600 flex-shrink-0",children:e.jsx(z,{size:12})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-xs font-bold text-slate-800 dark:text-slate-200",children:[s.hours," Hours"]}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:s.date})]}),e.jsx("p",{className:"text-[10px] text-slate-500 truncate max-w-[150px]",children:s.topic||"General Study"})]})]},s.id)),f.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400 italic text-xs",children:"No study logs yet."})]})})]})]}),x==="notes"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[H.map(s=>e.jsxs(d,{className:"group hover:border-primary-500/50 transition-all cursor-pointer",onClick:()=>r(`/notes/${s.id}`),children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-2xl bg-orange-500/10 text-orange-500 group-hover:bg-orange-500 group-hover:text-white transition-all",children:e.jsx(Z,{size:24})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-slate-100 truncate",children:s.title}),e.jsxs("p",{className:"text-[10px] text-slate-500 mt-1 uppercase tracking-wider font-black",children:["Edited: ",new Date(s.updatedAt||s.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mt-4 text-xs text-slate-600 dark:text-slate-400 line-clamp-3 leading-relaxed",children:[s.content?.replace(/[#*]/g,"").substring(0,150),"..."]})]},s.id)),e.jsxs("button",{onClick:()=>r("/notes"),className:"flex flex-col items-center justify-center p-8 rounded-3xl border-2 border-dashed border-slate-200 dark:border-slate-800 hover:border-primary-500/50 transition-all group",children:[e.jsx("div",{className:"p-4 rounded-full bg-slate-50 dark:bg-slate-800 text-slate-400 group-hover:text-primary-500 transition-all",children:e.jsx(T,{size:32})}),e.jsx("p",{className:"mt-4 text-xs font-black text-slate-400 uppercase tracking-widest group-hover:text-primary-500",children:"Create New Note"})]})]}),x==="flashcards"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[j.map(s=>e.jsxs(d,{title:s.name,HeaderAction:e.jsxs("span",{className:"text-[10px] font-black text-primary-500",children:[g.filter(a=>a.deckId===s.id).length," Cards"]}),children:[e.jsx("p",{className:"text-sm text-slate-500 mb-6",children:s.description||"Module-specific flashcards"}),e.jsxs(m,{fullWidth:!0,variant:"primary",className:"flex items-center justify-center gap-2",onClick:()=>r(`/flashcards/review/${s.id}`),children:[e.jsx(C,{size:16,fill:"currentColor"}),"Start Review"]})]},s.id)),e.jsxs("button",{onClick:()=>r("/flashcards"),className:"flex flex-col items-center justify-center p-8 rounded-3xl border-2 border-dashed border-slate-200 dark:border-slate-800 hover:border-primary-500/50 transition-all group",children:[e.jsx("div",{className:"p-4 rounded-full bg-slate-50 dark:bg-slate-800 text-slate-400 group-hover:text-primary-500 transition-all",children:e.jsx(T,{size:32})}),e.jsx("p",{className:"mt-4 text-xs font-black text-slate-400 uppercase tracking-widest group-hover:text-primary-500",children:"Add Study Deck"})]})]})]}):e.jsx(v,{title:"Not Found",children:e.jsxs("div",{className:"text-center py-12",children:["Module not found. ",e.jsx(m,{onClick:()=>r("/modules"),children:"Go Back"})]})})};export{oe as default};
