import{r as w,j as e}from"./vendor-BHBgCXd7.js";import{L as z}from"./Layout-BW6pkOKI.js";import{C as j}from"./Card-FPDh96Dz.js";import{u as d}from"./useFirestore-BslRrM8B.js";import{s as C,p as D,t as S,m as F,n as T,c as B}from"./index-DJ53ofb6.js";import{g as A}from"./colors-CkJud7t-.js";import{Z as H,k as I,a5 as E,B as W,z as v,a6 as L,a7 as $}from"./icons-BEGX_Ie2.js";import"./Button-Cg-uFP-H.js";const J=()=>{const{data:m}=d(F.getAll),{data:y}=d(T.getAll),{data:M}=d(B.getAll),{data:h}=d(D.getAll),{data:p}=d(C.getAll),{data:u}=d(S.getAll),k=w.useMemo(()=>{if(p.length===0)return 0;const s=p.reduce((o,n)=>o+parseFloat(n.hours||0),0),r=h.length*25/60,a=u.filter(o=>o.status==="Completed").length,i=r/(s||1)*100,l=a/(u.length||1)*100;return Math.min(Math.round((i+l)/2),100)},[p,h,u]),g=w.useMemo(()=>{const s=[],r=[];return s.push({id:"user",type:"user",label:"My Brain",x:400,y:300}),m.forEach((a,i)=>{const l=i/(m.length||1)*2*Math.PI,o=400+150*Math.cos(l),n=300+150*Math.sin(l);s.push({id:a.id,type:"module",label:a.name,x:o,y:n,color:A(a.id,i)}),r.push({source:"user",target:a.id}),y.filter(c=>c.moduleId===a.id).slice(0,3).forEach((c,x)=>{const f=l+(x-1)*.3;s.push({id:c.id,type:"note",label:c.title,x:o+80*Math.cos(f),y:n+80*Math.sin(f)}),r.push({source:a.id,target:c.id})})}),{nodes:s,links:r}},[m,y]);return e.jsxs(z,{title:"Deep Work Analytics",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 mb-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(j,{className:"bg-gradient-to-br from-primary-600 to-primary-900 border-none text-white overflow-hidden relative",children:[e.jsx(H,{size:120,className:"absolute -bottom-8 -right-8 opacity-20 rotate-12"}),e.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest opacity-70 mb-1",children:"Efficiency Score"}),e.jsxs("h2",{className:"text-5xl font-black mb-4",children:[k,"%"]}),e.jsxs("div",{className:"space-y-4 relative z-10",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold",children:[e.jsx("span",{children:"Focus Intensity"}),e.jsx("span",{className:"opacity-80",children:"High"})]}),e.jsx("div",{className:"h-1.5 w-full bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${k}%`}})}),e.jsx("p",{className:"text-[10px] italic leading-relaxed opacity-80",children:"Your productivity is 20% higher in the mornings."})]})]}),e.jsx(j,{title:"Focus Breakdown",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{size:14,className:"text-primary-500"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Total Pomodoros"})]}),e.jsx("span",{className:"font-bold dark:text-slate-200",children:h.length})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{size:14,className:"text-green-500"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Deep Work Time"})]}),e.jsxs("span",{className:"font-bold dark:text-slate-200",children:[Math.round(h.length*25/60),"h"]})]})]})})]}),e.jsxs(j,{className:"lg:col-span-3 overflow-hidden",HeaderAction:e.jsx(L,{size:18,className:"text-slate-300"}),children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(W,{size:18,className:"text-primary-500"}),"Knowledge Graph"]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Visualization of semantic connections between your study resources."})]}),e.jsxs("div",{className:"relative h-[500px] w-full bg-slate-50 dark:bg-slate-900/50 rounded-3xl border border-slate-100 dark:border-slate-800 shadow-inner overflow-hidden",children:[e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 800 600",children:[g.links.map((s,r)=>{const a=g.nodes.find(l=>l.id===s.source),i=g.nodes.find(l=>l.id===s.target);return!a||!i?null:e.jsx("line",{x1:a.x,y1:a.y,x2:i.x,y2:i.y,stroke:"currentColor",className:"text-slate-200 dark:text-slate-800",strokeWidth:"1.5",strokeDasharray:"4 4"},r)}),g.nodes.map(s=>e.jsxs("g",{className:"cursor-pointer group",children:[e.jsx("circle",{cx:s.x,cy:s.y,r:s.type==="user"?25:s.type==="module"?12:6,fill:s.type==="user"?"var(--color-primary-600)":s.type==="module"?s.color:"var(--color-slate-300)",className:s.type==="user"?"shadow-xl":""}),e.jsx("text",{x:s.x,y:s.y+(s.type==="user"?45:s.type==="module"?25:15),textAnchor:"middle",className:"text-[10px] font-bold fill-slate-500 dark:fill-slate-400 invisible group-hover:visible",children:s.label})]},s.id))]}),e.jsxs("div",{className:"absolute top-4 right-4 p-4 bg-white/80 dark:bg-slate-800/80 backdrop-blur rounded-2xl border border-slate-100 dark:border-slate-700 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold",children:[e.jsx(v,{size:10,className:"fill-primary-600 text-primary-600"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Core Knowledge"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold",children:[e.jsx(v,{size:10,className:"fill-primary-400 text-primary-400"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Active Modules"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold",children:[e.jsx(v,{size:10,className:"fill-slate-300 text-slate-300"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Related Notes"})]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:m.map(s=>{const r=u.filter(t=>t.moduleId===s.id),a=r.filter(t=>t.status==="Completed").length,i=p.filter(t=>t.moduleId===s.id),l=new Date,o=new Date(l.getTime()-10080*60*1e3),n=new Date(l.getTime()-336*60*60*1e3),N=i.filter(t=>new Date(t.date)>=o).reduce((t,b)=>t+parseFloat(b.hours||0),0),c=i.filter(t=>new Date(t.date)>=n&&new Date(t.date)<o).reduce((t,b)=>t+parseFloat(b.hours||0),0),x=c===0?N>0?100:0:Math.round((N-c)/c*100),f=r.length>0?a/r.length*100:0;return e.jsx(j,{title:s.name,className:"dark:bg-slate-800",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"Mastery Velocity"}),e.jsxs("span",{className:`font-bold ${x>=0?"text-primary-500":"text-red-500"}`,children:[x>=0?"+":"",x,"% this week"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:bg-slate-900 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-1000",style:{width:`${f}%`,backgroundColor:A(s.id)}})}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-400",children:[e.jsx($,{size:12}),e.jsxs("span",{children:["Associated items: ",y.filter(t=>t.moduleId===s.id).length," Notes, ",M.filter(t=>t.moduleId===s.id).length," Cards"]})]})]})},s.id)})})]})};export{J as default};
