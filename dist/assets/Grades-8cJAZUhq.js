import{r as j,j as e}from"./vendor-BHBgCXd7.js";import{L as F}from"./Layout-BW6pkOKI.js";import{C as f}from"./Card-FPDh96Dz.js";import{B as b}from"./Button-Cg-uFP-H.js";import{I as p}from"./Input-Bxxkotjn.js";import{M as I}from"./Modal-DoZe7KXC.js";import{u as k}from"./useFirestore-BslRrM8B.js";import{m as T,g as u}from"./index-DJ53ofb6.js";import{m as M,P as z,t as R,u as W,X as q,T as D}from"./icons-BEGX_Ie2.js";const $=()=>{const{data:g,refresh:N}=k(u.getAll),{data:o}=k(T.getAll),[A,m]=j.useState(!1),[h,y]=j.useState(null),[t,i]=j.useState({moduleId:"",name:"",score:"",total:"100",weight:"10",type:"Assignment"}),C=["Assignment","Quiz","Midterm","Final","Project","Lab"],G=async s=>{s.preventDefault();const r={...t,score:parseFloat(t.score),total:parseFloat(t.total),weight:parseFloat(t.weight)};h?await u.update(h.id,r):await u.add(r),await N(),m(!1),i({moduleId:"",name:"",score:"",total:"100",weight:"10",type:"Assignment"})},v=(s=null)=>{s?(y(s),i({moduleId:s.moduleId,name:s.name,score:s.score.toString(),total:s.total.toString(),weight:s.weight.toString(),type:s.type})):(y(null),i({moduleId:"",name:"",score:"",total:"100",weight:"10",type:"Assignment"})),m(!0)},S=async s=>{window.confirm("Delete this grade record?")&&(await u.delete(s),await N())},x=s=>{const r=g.filter(a=>a.moduleId===s);if(r.length===0)return{score:0,weight:0};let d=0,n=0;return r.forEach(a=>{const c=a.score/a.total*100;d+=c*(a.weight/100),n+=a.weight}),{score:d,currentWeight:n}},w=s=>s>=90?{gpa:"4.0",grade:"A"}:s>=80?{gpa:"3.0",grade:"B"}:s>=70?{gpa:"2.0",grade:"C"}:s>=60?{gpa:"1.0",grade:"D"}:{gpa:"0.0",grade:"F"},P=()=>{if(o.length===0)return 0;let s=0,r=0;return o.forEach(d=>{const{score:n,currentWeight:a}=x(d.id);if(a>0){const c=n/a*100;s+=parseFloat(w(c).gpa),r++}}),r>0?(s/r).toFixed(2):"N/A"};return e.jsxs(F,{title:"Grade & GPA Tracker",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Academic Performance"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Monitor your grades and project your final GPA."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"px-6 py-3 bg-primary-600 rounded-2xl text-white shadow-xl shadow-primary-200 dark:shadow-none flex items-center gap-4",children:[e.jsx(M,{size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase font-bold opacity-80 tracking-widest",children:"Current Cumulative GPA"}),e.jsx("h2",{className:"text-2xl font-black",children:P()})]})]}),e.jsxs(b,{onClick:()=>v(),className:"flex items-center gap-2 h-fit self-center",children:[e.jsx(z,{size:20}),e.jsx("span",{children:"Add Grade"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:o.map(s=>{const{score:r,currentWeight:d}=x(s.id),n=d>0?(r/d*100).toFixed(1):0,{grade:a}=w(n),c=g.filter(l=>l.moduleId===s.id);return e.jsx(f,{title:s.name,HeaderAction:e.jsxs("span",{className:`px-2 py-1 rounded-lg text-xs font-bold ${a==="A"?"bg-green-100 text-green-600":a==="B"?"bg-blue-100 text-blue-600":"bg-slate-100 text-slate-600"}`,children:["Current Grade: ",a," (",n,"%)"]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-slate-400 text-[10px] uppercase tracking-wider border-b border-slate-50 dark:border-slate-800",children:[e.jsx("th",{className:"pb-2 font-semibold",children:"Assessment"}),e.jsx("th",{className:"pb-2 font-semibold",children:"Category"}),e.jsx("th",{className:"pb-2 font-semibold",children:"Score"}),e.jsx("th",{className:"pb-2 font-semibold",children:"Weight"}),e.jsx("th",{className:"pb-2 font-semibold text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:[c.map(l=>e.jsxs("tr",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("td",{className:"py-3 font-medium",children:l.name}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:"bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded text-[10px] font-bold",children:l.type})}),e.jsxs("td",{className:"py-3 font-semibold",children:[l.score,"/",l.total]}),e.jsxs("td",{className:"py-3",children:[l.weight,"%"]}),e.jsxs("td",{className:"py-3 text-right space-x-1",children:[e.jsx("button",{onClick:()=>v(l),className:"p-1.5 text-slate-400 hover:text-primary-600 transition-colors",children:e.jsx(R,{size:14})}),e.jsx("button",{onClick:()=>S(l.id),className:"p-1.5 text-slate-400 hover:text-red-500 transition-colors",children:e.jsx(W,{size:14})})]})]},l.id)),c.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"py-8 text-center text-slate-400 italic text-xs",children:"No grade records for this module."})})]})]})}),e.jsxs("div",{className:"pt-4 border-t border-slate-50 dark:border-slate-800 flex justify-between items-center text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[e.jsx(q,{size:14}),e.jsxs("span",{children:["Current Weight: ",d,"% / 100%"]})]}),d<100&&e.jsx("div",{className:"text-primary-600 font-semibold italic",children:"Target: Reach 100% to finalize grade projection"})]})]})},s.id)})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(f,{title:"GPA Projection",className:"bg-gradient-to-br from-primary-600 to-primary-800 !text-white border-none",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{size:48,className:"opacity-20 absolute top-4 right-4"}),e.jsxs("p",{className:"text-sm opacity-90 leading-relaxed",children:["To achieve a ",e.jsx("strong",{children:"First Class"})," degree, aim for a consistent module percentage above ",e.jsx("strong",{children:"70%"}),"."]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-white/10 rounded-xl",children:[e.jsx("h4",{className:"text-sm font-bold mb-1",children:"Pass Requirement"}),e.jsx("p",{className:"text-xs opacity-80",children:"You need to maintain 40% across all modules to pass the year."})]}),e.jsxs("div",{className:"p-3 bg-white/10 rounded-xl",children:[e.jsx("h4",{className:"text-sm font-bold mb-1",children:"Dean's List"}),e.jsx("p",{className:"text-xs opacity-80",children:"Requires a GPA above 3.8 and no module below 85%."})]})]})]})}),e.jsx(f,{title:"Grade Summary",className:"dark:bg-slate-800",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Modules Tracked"}),e.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-100",children:o.length})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Total Assessments"}),e.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-100",children:g.length})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-100 dark:border-slate-800",children:[e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-3",children:"Top Performing"}),o.slice(0,3).map(s=>e.jsxs("div",{className:"flex justify-between items-center text-xs mb-2",children:[e.jsx("span",{className:"truncate w-32 dark:text-slate-300",children:s.name}),e.jsxs("span",{className:"text-primary-600 font-bold",children:[x(s.id).currentWeight>0?(x(s.id).score/x(s.id).currentWeight*100).toFixed(0):0,"%"]})]},s.id))]})]})})]})]}),e.jsx(I,{isOpen:A,onClose:()=>m(!1),title:h?"Edit Grade Record":"Record New Grade",footer:e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx(b,{variant:"primary",onClick:G,children:h?"Update Record":"Save Record"})]}),children:e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Module"}),e.jsxs("select",{className:"px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 dark:text-slate-100",value:t.moduleId,onChange:s=>i({...t,moduleId:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select a module"}),o.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx(p,{label:"Assessment Name",placeholder:"e.g. Midterm Lab Report",value:t.name,onChange:s=>i({...t,name:s.target.value}),required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Type"}),e.jsx("select",{className:"px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 dark:text-slate-100",value:t.type,onChange:s=>i({...t,type:s.target.value}),children:C.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx(p,{label:"Weight (%)",type:"number",placeholder:"e.g. 20",value:t.weight,onChange:s=>i({...t,weight:s.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(p,{label:"Score",type:"number",placeholder:"e.g. 85",value:t.score,onChange:s=>i({...t,score:s.target.value}),required:!0}),e.jsx(p,{label:"Total Possible",type:"number",placeholder:"e.g. 100",value:t.total,onChange:s=>i({...t,total:s.target.value}),required:!0})]})]})})]})};export{$ as default};
