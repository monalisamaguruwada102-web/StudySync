import{r as h,j as e}from"./vendor-BHBgCXd7.js";import{L as M}from"./Layout-BW6pkOKI.js";import{C as D}from"./Card-FPDh96Dz.js";import{B as i}from"./Button-Cg-uFP-H.js";import{I as m}from"./Input-Bxxkotjn.js";import{M as L}from"./Modal-DoZe7KXC.js";import{u as j}from"./useFirestore-BslRrM8B.js";import{s as x,m as I}from"./index-DJ53ofb6.js";import{D as T,P as z,q,v as A,l as F,u as H,H as B}from"./icons-BEGX_Ie2.js";import{f as p}from"./format-DmV111vt.js";import"./startOfWeek-Bny05VrO.js";import"./toDate-BKXxHYqX.js";import"./startOfDay-jrD5UjnC.js";const X=()=>{const{data:d,loading:y,refresh:u}=j(x.getAll),{data:n}=j(I.getAll),[f,o]=h.useState(!1),N=()=>{const s=["Date","Module","Topic","Hours"],c=d.map(l=>[l.date,n.find(k=>k.id===l.moduleId)?.name||"Unknown",l.topic,l.hours]),S=[s.join(","),...c.map(l=>l.join(","))].join(`
`),C=new Blob([S],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),w=URL.createObjectURL(C);a.setAttribute("href",w),a.setAttribute("download",`study_logs_${p(new Date,"yyyy_MM_dd")}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},[t,r]=h.useState({date:p(new Date,"yyyy-MM-dd"),moduleId:"",topic:"",hours:""}),v=async s=>{s.preventDefault(),await x.add({...t,hours:parseFloat(t.hours)}),await u(),o(!1),r({date:p(new Date,"yyyy-MM-dd"),moduleId:"",topic:"",hours:""})},g=async s=>{window.confirm("Delete this study log?")&&(await x.delete(s),await u())},b=s=>n.find(c=>c.id===s)?.name||"Deleted Module";return e.jsxs(M,{title:"Study Logs",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Study History"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Keep track of every minute spent on your modules."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(i,{variant:"secondary",onClick:N,className:"flex items-center gap-2 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-700",children:[e.jsx(T,{size:20}),e.jsx("span",{children:"Export CSV"})]}),e.jsxs(i,{onClick:()=>o(!0),className:"flex items-center gap-2",children:[e.jsx(z,{size:20}),e.jsx("span",{children:"Log Session"})]})]})]}),e.jsx(D,{className:"overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 text-slate-400 text-xs uppercase tracking-wider",children:[e.jsx("th",{className:"px-6 py-4 font-medium",children:"Date"}),e.jsx("th",{className:"px-6 py-4 font-medium",children:"Module"}),e.jsx("th",{className:"px-6 py-4 font-medium",children:"Topic"}),e.jsx("th",{className:"px-6 py-4 font-medium",children:"Time Spent"}),e.jsx("th",{className:"px-6 py-4 font-medium",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[d.map(s=>e.jsxs("tr",{className:"text-slate-700 hover:bg-slate-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-sm font-medium",children:s.date})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm px-2 py-1 bg-primary-50 text-primary-600 rounded-md font-medium",children:b(s.moduleId)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-sm",children:s.topic})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{size:14,className:"text-slate-400"}),e.jsxs("span",{className:"text-sm font-semibold",children:[s.hours," hours"]})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx(i,{variant:"ghost",onClick:()=>g(s.id),className:"!p-2 text-slate-400 hover:text-red-500",children:e.jsx(H,{size:16})})})]},s.id)),d.length===0&&!y&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",className:"px-6 py-12 text-center text-slate-400 italic",children:[e.jsx(B,{size:40,className:"mx-auto mb-3 opacity-20"}),"No study logs yet. Start your first session!"]})})]})]})})}),e.jsx(L,{isOpen:f,onClose:()=>o(!1),title:"Log Study Session",footer:e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsx(i,{variant:"primary",onClick:v,children:"Save Log"})]}),children:e.jsxs("form",{className:"space-y-4",children:[e.jsx(m,{label:"Date",type:"date",value:t.date,onChange:s=>r({...t,date:s.target.value}),required:!0}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Module"}),e.jsxs("select",{className:"px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500",value:t.moduleId,onChange:s=>r({...t,moduleId:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select a module"}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx(m,{label:"Topic / Subject",placeholder:"e.g. Binary Search Trees",value:t.topic,onChange:s=>r({...t,topic:s.target.value}),required:!0}),e.jsx(m,{label:"Time Spent (Hours)",type:"number",step:"0.1",placeholder:"e.g. 1.5",value:t.hours,onChange:s=>r({...t,hours:s.target.value}),required:!0})]})})]})};export{X as default};
